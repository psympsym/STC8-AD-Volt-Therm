C51 COMPILER V9.60.0.0   KEY                                                               06/08/2023 18:51:09 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE KEY
OBJECT MODULE PLACED IN .\Objects\KEY.obj
COMPILER INVOKED BY: D:\Keil\C51\BIN\C51.EXE Drivers\KEY\KEY.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\User;.\Drivers;.\STC8Ax
                    -_LIB\Core\Startup;.\STC8Ax_LIB\inc;.\STC8Ax_LIB\Core) DEBUG OBJECTEXTEND PRINT(.\Listings\KEY.lst) OBJECT(.\Objects\KEY.
                    -obj)

line level    source

   1          /*-------------------------------------------------------------------
   2          /*      (C) Copyright 2021-2022, nbufe. All Rights Reserved
   3          /*-------------------------------------------------------------------
   4          /* File name   : EX04_KEY1.c
   5          /* Description : ¶ÀÁ¢°´¼üµÄË«»÷°´¼ü´¥·¢
   6          /* Author      : nbufe
   7          /*-------------------------------------------------------------------
   8          /* Ó²¼þÆ½Ì¨£ºSTC8Ax ¿ª·¢°å¡£
   9          /* ÊµÏÖ¹¦ÄÜ£º¶ÀÁ¢°´¼üË«»÷£¬Ã¿Ë«»÷Ò»¸ö¶ÀÁ¢°´¼ü£¬¶ÔÓ¦ LED µÆ·´×ª¡£
  10          /* Update note:
  11          /* ---------   -----------   ----------------------------------------
  12          /*   Date        Author                       Note
  13          /* ---------   -----------   ----------------------------------------
  14          /*
  15          /*
  16          **/
  17          
  18          /* °üº¬Í·ÎÄ¼þ -------------------------------------------------------*/
  19          #include "STC8Ax_GPIO.h"
  20          #include "KEY.h"
  21          #include "led.h"
*** WARNING C318 IN LINE 21 OF Drivers\KEY\KEY.c: can't open file 'led.h'
  22          
  23          /* Ë½ÓÐÀàÐÍ¶¨Òå -----------------------------------------------------*/
  24          /* None. */
  25          
  26          /* Ë½ÓÐºê¶¨Òå -------------------------------------------------------*/
  27          /*
  28          * °´¼üÈ¥¶¶¶¯ÑÓÊ±µÄÊ±¼ä
  29          * µ÷Õû¶¶¶¯Ê±¼ä·§ÖµµÄ´óÐ¡£¬¿ÉÒÔ¸ü¸Ä°´¼üµÄ´¥·¢ÁéÃô¶È¡£
  30          * È¥¶¶¶¯µÄÊ±¼ä±¾ÖÊÉÏµÈÓÚÀÛ¼Æ¶¨Ê±ÖÐ¶Ï´ÎÊýµÄÊ±¼ä¡£
  31          */
  32          #define CONST_KEY_TIMES                         20              //¶Ì°´µÄ°´¼üÈ¥¶¶¶¯ÑÓÊ±Ê±¼ä
  33          #define CONST_KEY_TIMES_LONG   400   //³¤°´µÄ°´¼üÈ¥¶¶¶¯ÑÓÊ±Ê±¼ä  
  34          
  35          /*
  36          * Á¬ÐøÁ½´Î°´¼üÖ®¼äµÄÓÐÐ§Ê±¼ä²î
  37          * ÓÐÐ§Ê±¼ä²î£¬ÊÇÖ¸Á¬ÐøÁ½´Î°´¼ü´¥·¢µÄ×î´óÓÐÐ§¼ä¸ôÊ±¼ä¡£
  38          * Èç¹ûË«»÷µÄÁ½¸ö°´¼ü°´ÏÂµÄÊ±¼ä¼ä¸ôÌ«³¤£¬ÔòÊÓÎªÎÞÐ§Ë«»÷¡£
  39          */
  40          #define CONST_INTERVAL_TIME     200
  41          
  42          #define CONST_TIME_250MS                111   //0.25ÃëÖÓµÄÊ±¼äÐèÒªµÄ¶¨Ê±ÖÐ¶Ï´ÎÊý
  43          #define CONST_TIME_1000MS     444   //2ÃëÖÓµÄÊ±¼äÐèÒªµÄ¶¨Ê±ÖÐ¶Ï´ÎÊý
  44          
  45          
  46          /* Ë½ÓÐ±äÁ¿ ---------------------------------------------------------*/
  47          /* Ë«»÷ */
  48          unsigned int  KeyTimeCnt1 = 0;                  //°´¼üÈ¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷
  49          unsigned char KeyLock1 = 0;                             //°´¼ü´¥·¢ºó×ÔËøµÄ±äÁ¿±êÖ¾
  50          unsigned char KeyTouchCnt1 = 0;                 //°´¼ü°´ÏÂµÄ´ÎÊý¼ÇÂ¼
  51          unsigned int  KeyIntervalCnt1 = 0;      //°´¼ü¼ä¸ôµÄÊ±¼ä¼ÆÊýÆ÷
  52          
C51 COMPILER V9.60.0.0   KEY                                                               06/08/2023 18:51:09 PAGE 2   

  53          /* ×éºÏ */
  54          unsigned int  KeyTimeCnt12 = 0;                 //°´¼üÈ¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷
  55          unsigned char KeyLock12 = 0;                            //°´¼ü´¥·¢ºó×ÔËøµÄ±äÁ¿±êÖ¾
  56          
  57          /* ³¤°´Óë¶Ì°´ */
  58          unsigned int  KeyTimeCnt2 = 0;                  //°´¼üÈ¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷
  59          unsigned char KeyLock2 = 0;                             //°´¼ü´¥·¢ºó×ÔËøµÄ±äÁ¿±êÖ¾
  60          unsigned char KeyShortTouchFlag = 0; //¶Ì°´µÄ´¥·¢±êÖ¾
  61          
  62          /* ³¤°´Á¬Ðø²½½ø´¥·¢ */
  63          unsigned int  KeyTimeCnt3 = 0;                  //°´¼üÈ¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷
  64          unsigned char KeyLock3 = 0;                             //°´¼ü´¥·¢ºó×ÔËøµÄ±äÁ¿±êÖ¾
  65          unsigned char KeyCtntyCnt3 = 0;                 //°´¼üÁ¬Ðø´¥·¢µÄ¼ä¸ôÑÓÊ±¼ÆÊýÆ÷
  66          
  67          /* µ¥»÷ */
  68          unsigned int  KeyTimeCnt4 = 0;                  //°´¼üÈ¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷
  69          unsigned char KeyLock4 = 0;                             //°´¼ü´¥·¢ºó×ÔËøµÄ±äÁ¿±êÖ¾
  70          
  71          /* À©Õ¹±äÁ¿ ---------------------------------------------------------*/
  72          unsigned char KeySec = 0;                               //±»´¥·¢µÄ°´¼ü±àºÅ
  73          
  74          /* Ë½ÓÐº¯ÊýÔ­ÐÎ -----------------------------------------------------*/
  75          /* None. */
  76          
  77          /* º¯ÊýÌå -----------------------------------------------------------*/
  78          /*
  79           * ¹¦ÄÜ: ¶ÀÁ¢Ë«»÷°´¼ü
  80           * ²ÎÊý: None
  81           * ·µ»Ø: None
  82           * ËµÃ÷: None
  83           */
  84          
  85          void Key_Scan()//°´¼üÉ¨Ãèº¯Êý ·ÅÔÚ¶¨Ê±ÖÐ¶ÏÀï
  86          {
  87   1          /*
  88   1          * Ë«»÷°´¼üÉ¨ÃèµÄÏêÏ¸¹ý³Ì£º
  89   1          * µÚÒ»²½£ºÆ½Ê±Ã»ÓÐ°´¼ü±»´¥·¢Ê±£¬°´¼üµÄ×ÔËø±êÖ¾,È¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷Ò»Ö±±»ÇåÁã¡£
  90   1          *         Èç¹ûÖ®Ç°ÒÑ¾­ÓÐ°´¼ü´¥·¢¹ýÒ»´Î£¬ÄÇÃ´Æô¶¯Ê±¼ä¼ä¸ô¼ÆÊýÆ÷KeyIntervalCnt1£¬
  91   1          *         ÔÚÕâ¸öÔÊÐíµÄÊ±¼ä²î·¶Î§ÄÚ£¬Èç¹ûÒ»Ö±Ã»ÓÐµÚ¶þ´Î°´¼ü´¥·¢£¬Ôò°ÑÀÛ¼Ó°´¼ü´¥·¢µÄ
  92   1          *         ´ÎÊýKeyTouchCnt1Ò²ÇåÁã¡£
  93   1          * µÚ¶þ²½£ºÒ»µ©ÓÐ°´¼ü±»°´ÏÂ£¬È¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷¿ªÊ¼ÔÚ¶¨Ê±ÖÐ¶Ïº¯ÊýÀïÀÛ¼Ó£¬ÔÚ»¹Ã»ÀÛ¼Óµ½
  94   1          *         ·§ÖµCONST_KEY_TIMESÊ±£¬Èç¹ûÔÚÕâÆÚ¼äÓÉÓÚÊÜÍâ½ç¸ÉÈÅ»òÕß°´¼ü¶¶¶¯£¬¶øÊ¹ IO ¿Ú
  95   1          *         Í»È»Ë²¼ä´¥·¢³É¸ßµçÆ½£¬Õâ¸öÊ±ºòÂíÉÏ°ÑÑÓÊ±¼ÆÊýÆ÷ KeyTimeCnt1 ÇåÁãÁË,Õâ¸ö¹ý
  96   1          *         ³Ì·Ç³£ÇÉÃî£¬·Ç³£ÓÐÐ§µØÈ¥³ýË²¼äµÄÔÓ²¨¸ÉÈÅ¡£
  97   1          *         ÒÔºó·²ÊÇÓÃµ½¿ª¹Ø¸ÐÓ¦Æ÷µÄÊ±ºò£¬¶¼¿ÉÒÔÓÃÀàËÆÕâÑùµÄ·½·¨È¥¸ÉÈÅ¡£
  98   1          * µÚÈý²½£ºÈç¹û°´¼ü°´ÏÂµÄÊ±¼ä³¬¹ýÁË·§ÖµCONST_KEY_TIMES£¬ÂíÉÏ°Ñ×ÔËø±êÖ¾KeyLock1ÖÃÎ»£¬
  99   1          *         ·ÀÖ¹°´×¡°´¼ü²»ËÉÊÖºóÒ»Ö±´¥·¢¡£Óë´ËÍ¬Ê±£¬ÀÛ¼ÓÒ»´Î°´¼ü´ÎÊý£¬Èç¹û°´¼ü´ÎÊýÀÛ
 100   1          *           ¼ÓÓÐÁ½´ÎÒÔÉÏ£¬ÔòÈÏÎª´¥·¢Ë«»÷°´¼ü£¬²¢°Ñ±àºÅKeySec¸³Öµ¡£
 101   1          * µÚËÄ²½£ºµÈ°´¼üËÉ¿ªºó£¬×ÔËø±êÖ¾KeyLock1¼°Ê±ÇåÁã£¬ÎªÏÂÒ»´Î×ÔËø×ö×¼±¸¡£²¢ÇÒÀÛ¼Ó¼ä¸ô
 102   1          *           Ê±¼ä£¬·ÀÖ¹Á½´Î°´¼üµÄ¼ä¸ôÊ±¼äÌ«³¤¡£
 103   1          */
 104   1          if(key_sr1 == 1) //IOÊÇ¸ßµçÆ½£¬ËµÃ÷°´¼üÃ»ÓÐ±»°´ÏÂ£¬ÕâÊ±Òª¼°Ê±ÇåÁãÒ»Ð©±êÖ¾Î»
 105   1          {
 106   2              KeyLock1 = 0; //°´¼ü×ÔËø±êÖ¾ÇåÁã
 107   2              KeyTimeCnt1 = 0; //°´¼üÈ¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷ÇåÁã£¬´ËÐÐ·Ç³£ÇÉÃî£¬ÊÇÎÒÊµÕ½ÖÐÃþË÷³öÀ´µÄ¡£
 108   2              if(KeyTouchCnt1 > 0) //Ö®Ç°ÒÑ¾­ÓÐ°´¼ü´¥·¢¹ýÒ»´Î£¬ÔÙÀ´Ò»´Î¾Í¹¹³ÉË«»÷
 109   2              {
 110   3                  KeyIntervalCnt1++; //°´¼ü¼ä¸ôµÄÊ±¼ä¼ÆÊýÆ÷ÀÛ¼Ó
 111   3                  if(KeyIntervalCnt1 > CONST_INTERVAL_TIME) //³¬¹ý×î´óÔÊÐíµÄ¼ä¸ôÊ±¼ä
 112   3                  {
 113   4                      KeyIntervalCnt1 = 0; //Ê±¼ä¼ÆÊýÆ÷ÇåÁã
 114   4                      KeyTouchCnt1 = 0; //ÇåÁã°´¼üµÄ°´ÏÂµÄ´ÎÊý
C51 COMPILER V9.60.0.0   KEY                                                               06/08/2023 18:51:09 PAGE 3   

 115   4                  }
 116   3              }
 117   2          }
 118   1          else if(KeyLock1 == 0) //ÓÐ°´¼ü°´ÏÂ£¬ÇÒÊÇµÚÒ»´Î±»°´ÏÂ
 119   1          {
 120   2              KeyTimeCnt1++; //ÀÛ¼Ó¶¨Ê±ÖÐ¶Ï´ÎÊý
 121   2              if(KeyTimeCnt1 > CONST_KEY_TIMES)
 122   2              {
 123   3                  KeyTimeCnt1 = 0;
 124   3                  KeyLock1 = 1; //×ÔËø°´¼üÖÃÎ»,±ÜÃâÒ»Ö±´¥·¢
 125   3                  KeyIntervalCnt1 = 0; //°´¼üÓÐÐ§¼ä¸ôµÄÊ±¼ä¼ÆÊýÆ÷ÇåÁã
 126   3      
 127   3                  KeyTouchCnt1++;
 128   3                  if(KeyTouchCnt1 > 1) //Á¬Ðø±»°´ÁËÁ½´ÎÒÔÉÏ
 129   3                  {
 130   4                      KeyTouchCnt1 = 0; //Í³¼Æ°´¼ü´ÎÊýÇåÁã
 131   4                      KeySec = 1;  //´¥·¢1ºÅ¼ü
 132   4                  }
 133   3              }
 134   2          }
 135   1      
 136   1          /*
 137   1          * ×éºÏ°´¼üÉ¨ÃèµÄÏêÏ¸¹ý³Ì£º
 138   1          * µÚÒ»²½£ºÆ½Ê±Ö»ÒªÁ½¸ö°´¼üÓÐÒ»¸öÃ»ÓÐ±»°´ÏÂ£¬°´¼üµÄ×ÔËø±êÖ¾,È¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷Ò»Ö±±»ÇåÁã¡£
 139   1          * µÚ¶þ²½£ºÒ»µ©Á½¸ö°´¼ü¶¼±»°´ÏÂ£¬È¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷¿ªÊ¼ÔÚ¶¨Ê±ÖÐ¶Ïº¯ÊýÀïÀÛ¼Ó£¬ÔÚ»¹Ã»ÀÛ¼Óµ½
 140   1          *         ·§Öµ CONST_KEY_TIMES Ê±£¬Èç¹ûÔÚÕâÆÚ¼äÓÉÓÚÊÜÍâ½ç¸ÉÈÅ»òÕß°´¼ü¶¶¶¯£¬¶øÊ¹ IO ¿Ú
 141   1          *         Í»È»Ë²¼ä´¥·¢³É¸ßµçÆ½£¬Õâ¸öÊ±ºòÂíÉÏ°ÑÑÓÊ±¼ÆÊýÆ÷ KeyTimeCnt12 ÇåÁãÁË,Õâ¸ö¹ý³Ì
 142   1          *         ·Ç³£ÇÉÃî£¬·Ç³£ÓÐÐ§µØÈ¥³ýË²¼äµÄÔÓ²¨¸ÉÈÅ¡£
 143   1          *         ÒÔºó·²ÊÇÓÃµ½¿ª¹Ø¸ÐÓ¦Æ÷µÄÊ±ºò£¬¶¼¿ÉÒÔÓÃÀàËÆÕâÑùµÄ·½·¨È¥¸ÉÈÅ¡£
 144   1          * µÚÈý²½£ºÈç¹û°´¼ü°´ÏÂµÄÊ±¼ä³¬¹ýÁË·§Öµ CONST_KEY_TIMES £¬ÂíÉÏ°Ñ×ÔËø±êÖ¾ KeyLock12 ÖÃÎ»£¬
 145   1          *         ·ÀÖ¹°´×¡°´¼ü²»ËÉÊÖºóÒ»Ö±´¥·¢¡£²¢°Ñ±àºÅ KeySec ¸³Öµ¡£ ×éºÏ°´¼ü´¥·¢
 146   1          * µÚËÄ²½£ºµÈ°´¼üËÉ¿ªºó£¬×ÔËø±êÖ¾ KeyLock12 ¼°Ê±ÇåÁã£¬ÎªÏÂÒ»´Î×ÔËø×ö×¼±¸¡£
 147   1          */
 148   1          if(key_sr1 == 1 || key_sr2 == 1) //IOÊÇ¸ßµçÆ½£¬ËµÃ÷Á½¸ö°´¼üÃ»ÓÐÈ«²¿±»°´ÏÂ£¬ÕâÊ±Òª¼°Ê±ÇåÁãÒ»Ð©±êÖ¾Î»
 149   1          {
 150   2              KeyLock12 = 0; //°´¼ü×ÔËø±êÖ¾ÇåÁã
 151   2              KeyTimeCnt12 = 0; //°´¼üÈ¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷ÇåÁã£¬´ËÐÐ·Ç³£ÇÉÃî¡£
 152   2          }
 153   1          else if(KeyLock12 == 0) //ÓÐ°´¼ü°´ÏÂ£¬ÇÒÊÇµÚÒ»´Î±»°´ÏÂ
 154   1          {
 155   2              KeyTimeCnt12++; //ÀÛ¼Ó¶¨Ê±ÖÐ¶Ï´ÎÊý
 156   2              if(KeyTimeCnt12 > CONST_KEY_TIMES)
 157   2              {
 158   3                  KeyTimeCnt12 = 0;
 159   3                  KeyLock12 = 1; //×ÔËø°´¼üÖÃÎ»,±ÜÃâÒ»Ö±´¥·¢
 160   3                  KeySec = 12;  //´¥·¢12ºÅ¼ü
 161   3              }
 162   2          }
 163   1          /*
 164   1          * ³¤°´Óë¶Ì°´µÄ°´¼üÉ¨ÃèµÄÏêÏ¸¹ý³Ì£º
 165   1          * µÚÒ»²½£ºÆ½Ê±Ö»Òª°´¼üÃ»ÓÐ±»°´ÏÂÊ±£¬°´¼üµÄ×ÔËø±êÖ¾,È¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷Ò»Ö±±»ÇåÁã¡£
 166   1          * µÚ¶þ²½£ºÒ»µ©°´¼ü¶¼±»°´ÏÂ£¬È¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷¿ªÊ¼ÔÚ¶¨Ê±ÖÐ¶Ïº¯ÊýÀïÀÛ¼Ó£¬ ÔÚ»¹Ã»ÀÛ¼Óµ½·§Öµ
 167   1          *         CONST_KEY_TIMES »ò CONST_KEY_TIMES_LONG Ê±£¬Èç¹ûÔÚÕâÆÚ¼äÓÉÓÚÊÜÍâ½ç¸ÉÈÅ»òÕß°´¼ü¶¶¶¯£¬
 168   1          *           ¶øÊ¹ IO ¿ÚÍ»È»Ë²¼ä´¥·¢³É¸ßµçÆ½£¬ÕâÊ±ÂíÉÏ°ÑÑÓÊ±¼ÆÊýÆ÷ KeyTimeCnt2 ÇåÁãÁË,Õâ¸ö¹ý³Ì
 169   1          *         ·Ç³£ÇÉÃî£¬·Ç³£ÓÐÐ§µØÈ¥³ýË²¼äµÄÔÓ²¨¸ÉÈÅ¡£
 170   1          *         ÒÔºó·²ÊÇÓÃµ½¿ª¹Ø¸ÐÓ¦Æ÷µÄÊ±ºò£¬¶¼¿ÉÒÔÓÃÀàËÆÕâÑùµÄ·½·¨È¥¸ÉÈÅ¡£
 171   1          * µÚÈý²½£ºÈç¹û°´¼ü°´ÏÂµÄÊ±¼ä³¬¹ýÁË¶Ì°´·§Öµ CONST_KEY_TIMES £¬ÔòÂíÉÏ°Ñ¶Ì°´±êÖ¾ KeyShortTouchFlag=1;
 172   1          *         Èç¹û»¹Ã»ÓÐËÉÊÖ£¬Ò»µ©·¢ÏÖ°´ÏÂµÄÊ±¼ä³¬¹ý³¤°´·§Öµ CONST_KEY_TIMES_LONG Ê±£¬ÏÈ°Ñ¶Ì°´±êÖ¾
 173   1          *         KeyShortTouchFlag ÇåÁã£¬È»ºó´¥·¢³¤°´¡£ÔÚÕâ¶Î³ÌÐòÀï£¬°Ñ×ÔËø±êÖ¾ KeyLock2 ÖÃÎ»,ÊÇÎªÁË
 174   1          *         ·ÀÖ¹°´×¡°´¼ü²»ËÉÊÖºóÒ»Ö±´¥·¢¡£
 175   1          * µÚËÄ²½£ºµÈ°´¼üËÉ¿ªºó£¬×ÔËø±êÖ¾ KeyLock2 ¼°Ê±ÇåÁã£¬ÎªÏÂÒ»´Î×ÔËø×ö×¼±¸¡£
 176   1          *           Èç¹û·¢ÏÖ KeyShortTouchFlag µÈÓÚ1£¬ËµÃ÷¶Ì°´ÓÐÐ§£¬ÕâÊ±´¥·¢Ò»´Î¶Ì°´¡£
C51 COMPILER V9.60.0.0   KEY                                                               06/08/2023 18:51:09 PAGE 4   

 177   1          */
 178   1      
 179   1          if(key_sr2 == 1) //IOÊÇ¸ßµçÆ½£¬ËµÃ÷Á½¸ö°´¼üÃ»ÓÐÈ«²¿±»°´ÏÂ£¬ÕâÊ±Òª¼°Ê±ÇåÁãÒ»Ð©±êÖ¾Î»
 180   1          {
 181   2              KeyLock2 = 0; //°´¼ü×ÔËø±êÖ¾ÇåÁã
 182   2              KeyTimeCnt2 = 0; //°´¼üÈ¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷ÇåÁã£¬´ËÐÐ·Ç³£ÇÉÃî¡£
 183   2              if(KeyShortTouchFlag == 1) //¶Ì°´´¥·¢±êÖ¾
 184   2              {
 185   3                  KeyShortTouchFlag = 0;
 186   3                  KeySec = 2;  //´¥·¢2ºÅ¼üµÄ¶Ì°´
 187   3              }
 188   2          }
 189   1          else if(KeyLock2 == 0) //ÓÐ°´¼ü°´ÏÂ£¬ÇÒÊÇµÚÒ»´Î±»°´ÏÂ
 190   1          {
 191   2              KeyTimeCnt2++; //ÀÛ¼Ó¶¨Ê±ÖÐ¶Ï´ÎÊý
 192   2              if(KeyTimeCnt2 > CONST_KEY_TIMES)
 193   2              {
 194   3                  KeyShortTouchFlag = 1; //¼¤»î°´¼ü¶Ì°´µÄÓÐÐ§±êÖ¾
 195   3              }
 196   2      
 197   2              if(KeyTimeCnt2 > CONST_KEY_TIMES_LONG)
 198   2              {
 199   3                  KeyShortTouchFlag = 0; //Çå³ý°´¼ü¶Ì°´µÄÓÐÐ§±êÖ¾
 200   3                  KeyTimeCnt2 = 0;
 201   3                  KeyLock2 = 1; //×ÔËø°´¼üÖÃÎ»,±ÜÃâÒ»Ö±´¥·¢
 202   3                  KeySec = 22;  //´¥·¢2ºÅ¼üµÄ³¤°´
 203   3      
 204   3              }
 205   2      
 206   2          }
 207   1      
 208   1          /*
 209   1          * °´×¡°´¼ü²»ËÉÊÖµÄÁ¬Ðø²½½ø´¥·¢É¨ÃèµÄÏêÏ¸¹ý³Ì£º
 210   1          * µÚÒ»²½£ºÆ½Ê±Ã»ÓÐ°´¼ü±»´¥·¢Ê±£¬°´¼üµÄ×ÔËø±êÖ¾,È¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷£¬ÒÔ¼°Ê±¼ä¼ä¸ôÑÓÊ±¼ÆÊýÆ÷Ò»Ö±±»ÇåÁã¡£
 211   1          * µÚ¶þ²½£ºÒ»µ©ÓÐ°´¼ü±»°´ÏÂ£¬È¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷¿ªÊ¼ÔÚ¶¨Ê±ÖÐ¶Ïº¯ÊýÀïÀÛ¼Ó£¬ÔÚ»¹Ã»ÀÛ¼Óµ½
 212   1          *         ·§Öµ CONST_KEY_TIMES Ê±£¬Èç¹ûÔÚÕâÆÚ¼äÓÉÓÚÊÜÍâ½ç¸ÉÈÅ»òÕß°´¼ü¶¶¶¯£¬¶øÊ¹
 213   1          *         IO¿ÚÍ»È»Ë²¼ä´¥·¢³É¸ßµçÆ½£¬Õâ¸öÊ±ºòÂíÉÏ°ÑÑÓÊ±¼ÆÊýÆ÷ KeyTimeCnt3
 214   1          *         ÇåÁãÁË,Õâ¸ö¹ý³Ì·Ç³£ÇÉÃî£¬·Ç³£ÓÐÐ§µØÈ¥³ýË²¼äµÄÔÓ²¨¸ÉÈÅ¡£ÕâÊÇÎÒÊµÕ½ÖÐÃþË÷³öÀ´µÄ¡£
 215   1          *         ÒÔºó·²ÊÇÓÃµ½¿ª¹Ø¸ÐÓ¦Æ÷µÄÊ±ºò£¬¶¼¿ÉÒÔÓÃÀàËÆÕâÑùµÄ·½·¨È¥¸ÉÈÅ¡£
 216   1          * µÚÈý²½£ºÈç¹û°´¼ü°´ÏÂµÄÊ±¼ä³¬¹ýÁË·§Öµ CONST_KEY_TIMES £¬Ôò´¥·¢°´¼ü£¬°Ñ±àºÅKeySec¸³Öµ¡£
 217   1          *         Í¬Ê±£¬ÂíÉÏ°Ñ×ÔËø±êÖ¾ KeyLock3 ÖÃÎ»£¬·ÀÖ¹°´×¡°´¼ü²»ËÉÊÖºóÒ»Ö±´¥·¢¡£
 218   1          * µÚËÄ²½£ºÈç¹û´ËÊ±´¥·¢ÁËÒ»´Î°´¼üºó£¬Ò»Ö±²»ËÉÊÖ£¬È¥¶¶¶¯ÑÓÊ±¼ÆÊ±Æ÷¼ÌÐøÀÛ¼Ó£¬Ö±µ½³¬¹ýÁË1ÃëÖÓ¡£½øÈëÁ¬Ðø´¥·
             -¢Ä£Ê½µÄ³ÌÐò
 219   1          * µÚÎå²½£ºÔÚÁ¬Ðø´¥·¢Ä£Ê½µÄ³ÌÐòÖÐ£¬Á¬ÐøÀÛ¼ÓÑÓÊ±¼ÆÊýÆ÷¿ªÊ¼ÀÛ¼Ó£¬Ã¿0.25Ãë¾Í´¥·¢Ò»´Î¡£
 220   1          * µÚÁù²½£ºµÈ°´¼üËÉ¿ªºó£¬×ÔËø±êÖ¾ KeyLock3 ºÍÁ½¸öÑÓÊ±¼ÆÊ±Æ÷¼°Ê±ÇåÁã£¬ÎªÏÂÒ»´Î×ÔËø×ö×¼±¸¡£
 221   1          */
 222   1          if(key_sr3 == 1) //IOÊÇ¸ßµçÆ½£¬ËµÃ÷°´¼üÃ»ÓÐ±»°´ÏÂ£¬ÕâÊ±Òª¼°Ê±ÇåÁãÒ»Ð©±êÖ¾Î»
 223   1          {
 224   2              KeyLock3 = 0; //°´¼ü×ÔËø±êÖ¾ÇåÁã
 225   2              KeyTimeCnt3 = 0; //°´¼üÈ¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷ÇåÁã£¬´ËÐÐ·Ç³£ÇÉÃî¡£
 226   2              KeyCtntyCnt3 = 0; //Á¬ÐøÀÛ¼ÓµÄÊ±¼ä¼ä¸ôÑÓÊ±¼ÆÊýÆ÷ÇåÁã
 227   2          }
 228   1          else if(KeyLock3 == 0) //ÓÐ°´¼ü°´ÏÂ£¬ÇÒÊÇµÚÒ»´Î±»°´ÏÂ
 229   1          {
 230   2              KeyTimeCnt3++; //ÀÛ¼Ó¶¨Ê±ÖÐ¶Ï´ÎÊý
 231   2              if(KeyTimeCnt3 > CONST_KEY_TIMES)
 232   2              {
 233   3                  KeyTimeCnt3 = 0;
 234   3                  KeyLock3 = 1; //×ÔËø°´¼üÖÃÎ»,±ÜÃâÒ»Ö±´¥·¢
 235   3                  KeySec = 3;  //´¥·¢3ºÅ¼ü
 236   3              }
 237   2          }
C51 COMPILER V9.60.0.0   KEY                                                               06/08/2023 18:51:09 PAGE 5   

 238   1          else if(KeyTimeCnt3 < CONST_TIME_1000MS) //°´×¡ÀÛ¼Óµ½1Ãë
 239   1          {
 240   2              KeyTimeCnt3++;
 241   2          }
 242   1          else  //°´×¡ÀÛ¼Óµ½2ÃëºóÈÔÈ»²»·ÅÊÖ£¬Õâ¸öÊ±ºò½øÈëÓÐ½Ú×àµÄÁ¬Ðø´¥·¢
 243   1          {
 244   2              KeyCtntyCnt3++; //Á¬Ðø´¥·¢ÑÓÊ±¼ÆÊýÆ÷ÀÛ¼Ó
 245   2              if(KeyCtntyCnt3 > CONST_TIME_250MS) //°´×¡Ã»ËÉÊÖ£¬Ã¿0.25Ãë¾Í´¥·¢Ò»´Î
 246   2              {
 247   3                  KeyCtntyCnt3 = 0; //
 248   3                  KeySec = 33;  //´¥·¢3ºÅ¼ü
 249   3              }
 250   2          }
 251   1      
 252   1          /*
 253   1          * ¶ÀÁ¢°´¼üÉ¨ÃèµÄÏêÏ¸¹ý³Ì£º
 254   1          * µÚÒ»²½£ºÆ½Ê±Ã»ÓÐ°´¼ü±»´¥·¢Ê±£¬°´¼üµÄ×ÔËø±êÖ¾,È¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷Ò»Ö±±»ÇåÁã¡£
 255   1          * µÚ¶þ²½£ºÒ»µ©ÓÐ°´¼ü±»°´ÏÂ£¬È¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷¿ªÊ¼ÔÚ¶¨Ê±ÖÐ¶Ïº¯ÊýÀïÀÛ¼Ó£¬ÔÚ»¹Ã»ÀÛ¼Óµ½
 256   1          *         ·§ÖµCONST_KEY_TIMES1Ê±£¬Èç¹ûÔÚÕâÆÚ¼äÓÉÓÚÊÜÍâ½ç¸ÉÈÅ»òÕß°´¼ü¶¶¶¯£¬¶øÊ¹
 257   1          *         IO¿ÚÍ»È»Ë²¼ä´¥·¢³É¸ßµçÆ½£¬Õâ¸öÊ±ºòÂíÉÏ°ÑÑÓÊ±¼ÆÊýÆ÷uiKeyTimeCnt1
 258   1          *         ÇåÁãÁË,Õâ¸ö¹ý³Ì·Ç³£ÇÉÃî£¬·Ç³£ÓÐÐ§µØÈ¥³ýË²¼äµÄÔÓ²¨¸ÉÈÅ¡£ÕâÊÇÎÒÊµÕ½ÖÐÃþË÷³öÀ´µÄ¡£
 259   1          *         ÒÔºó·²ÊÇÓÃµ½¿ª¹Ø¸ÐÓ¦Æ÷µÄÊ±ºò£¬¶¼¿ÉÒÔÓÃÀàËÆÕâÑùµÄ·½·¨È¥¸ÉÈÅ¡£
 260   1          * µÚÈý²½£ºÈç¹û°´¼ü°´ÏÂµÄÊ±¼ä³¬¹ýÁË·§ÖµCONST_KEY_TIMES1£¬Ôò´¥·¢°´¼ü£¬°Ñ±àºÅucKeySec¸³Öµ¡£
 261   1          *         Í¬Ê±£¬ÂíÉÏ°Ñ×ÔËø±êÖ¾ucKeyLock1ÖÃÎ»£¬·ÀÖ¹°´×¡°´¼ü²»ËÉÊÖºóÒ»Ö±´¥·¢¡£
 262   1          * µÚËÄ²½£ºµÈ°´¼üËÉ¿ªºó£¬×ÔËø±êÖ¾ucKeyLock1¼°Ê±ÇåÁã£¬ÎªÏÂÒ»´Î×ÔËø×ö×¼±¸¡£
 263   1          */
 264   1          if(key_sr4 == 1) //IOÊÇ¸ßµçÆ½£¬ËµÃ÷°´¼üÃ»ÓÐ±»°´ÏÂ£¬ÕâÊ±Òª¼°Ê±ÇåÁãÒ»Ð©±êÖ¾Î»
 265   1          {
 266   2              KeyLock4 = 0; //°´¼ü×ÔËø±êÖ¾ÇåÁã
 267   2              KeyTimeCnt4 = 0; //°´¼üÈ¥¶¶¶¯ÑÓÊ±¼ÆÊýÆ÷ÇåÁã£¬´ËÐÐ·Ç³£ÇÉÃî¡£
 268   2          }
 269   1          else if(KeyLock4 == 0) //ÓÐ°´¼ü°´ÏÂ£¬ÇÒÊÇµÚÒ»´Î±»°´ÏÂ
 270   1          {
 271   2              ++KeyTimeCnt4;  //ÑÓÊ±¼ÆÊýÆ÷
 272   2              if(KeyTimeCnt4 > CONST_KEY_TIMES)
 273   2              {
 274   3                  KeyTimeCnt4 = 0;
 275   3                  KeyLock4 = 1; //×ÔËø°´¼üÖÃÎ»,±ÜÃâÒ»Ö±´¥·¢
 276   3                  KeySec = 4;  //´¥·¢1ºÅ¼ü
 277   3              }
 278   2          }
 279   1      }
 280          
 281          
 282          
 283          /*>>>>>>>>>> (C) COPYRIGHT NBUFE <<<<<< >>>>>> END OF FILE <<<<<<<<<<*/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    349    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     21    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
